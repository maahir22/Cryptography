<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Cryptography</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    
    <link rel="stylesheet" href="css/bootstrap4-neon-glow.css">
    
    
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>
    
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/hmac-sha256.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/enc-base64.min.js"></script>  

  <div class="navbar-dark text-white">
    <div class="container">
      <nav class="navbar px-0 navbar-expand-lg navbar-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a href="index.html" class="pl-md-0 p-3 text-light">Home</a>
            <a href="pass.html" class="p-3 text-decoration-none text-light">Password Strength Checker</a>
          </div>
        </div>
      </nav>

    </div>
  </div>


<div class="jumbotron bg-transparent mb-0 radius-0">
  <div class="container">
      <div class="row">
        <div class="col-xl-6">
         <h1 class="display-2">Cryptograph<span class="vim-caret">y</span></h1>
          <div class="lead mb-3 text-mono text-success">A website to perform various methods of Encryption-Decryption and Hashing Algortihms</div>
          <div class="text-mono">
          </div>

          <div class="text-darkgrey text-mono my-2">Made by Maahir Sharma</div>

          <p class="mt-5 text-grey text-spacey">
            The tools implemented below are made for the sole purpose of testing,encrypting and decrypting. Drawbacks of certain methods will be highlighted soon.
          </p>
        </div>
      </div>
  </div>
</div>



<div class="container py-5">
  <h1>Basic XOR Encryption</h1>

  <p>A basic XOR Encryption tools works on the principle that if A^B = C then C^B = A , this is the most basic technique of Encryption and Decryption <br>

        <form name="Encryptor" class="card p-2" onsubmit="Encrypt();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Encrypt" name="fname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Encrypt</button>
          </div>
        </div>
      </form>
  
      <form name="Decryptor" class="card p-2" onsubmit="Decrypt();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Decrypt" name="secname">
          <div class="input-group-append">
            <div class="input-group">
          <input type="text" class="form-control" placeholder="Private Key" name="tertname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Decrypt</button>
          </div>
        </div>
      </form>
</div>
</div>
</form>
</p>
</div>

<div class="container py-5">
  <h1>HMAC SHA256 Base64 Hashing</h1>

  <p>A hash, unlike encryption is converted permanently, this technique is mainly used for Signatures.<br>

        <form name="Hashing" class="card p-2" onsubmit="Hash();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Hash" name="fname">
          <div class="input-group-append">
          <div class="input-group">
          <input type="text" class="form-control" placeholder="Secret Key" name="tertname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Hash</button>
          </div>
        </div>
      </form>
  
</div>
</div>
</form>
</p>
</div>

<div class="container py-5">
  <h1>RSA Encryption and Decryption Algorithm</h1>

  <p>This is a classical algorithm which is based upon Public and Private Keys. Public keys are used for encryption, on the other hand private key is used for decryption.<br>

        <form name="RSA_Encrypt" class="card p-2" onsubmit="rsa();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Encrypt Character Using RSA" name="fname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Encrypt</button>
          </div>
        </div>
      </form>

      <form name="RSA_Decrypt" class="card p-2" onsubmit="drsa();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Enter Encrypted Number obtained" name="fname">
          <div class="input-group-append">
                    <div class="input-group">
          <input type="text" class="form-control" placeholder="Enter Value of N" name="secname">
          <div class="input-group-append">
                    <div class="input-group">
          <input type="text" class="form-control" placeholder="Shhh! Enter Private key" name="tertname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Decrypt</button>
          </div>
        </div>
      </form>
  
</div>
</div>
</form>
</p>
</div>
</div>
</form>
</p>
</div>

<div class="container py-5">
  <h1>MD5 Hashing</h1>

  <p>MD5 Hash has been found to suffer from extensive vulnerabilities. It can still be used as a checksum to verify data integrity, but only against unintentional corruption..<br>

        <form name="MD5" class="card p-2" onsubmit="md5hash();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Hash" name="fname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Hash</button>
          </div>
        </div>
      </form>
  
</div>
</div>
</form>
</p>
</div>

<div class="container py-5">
  <h1>AES Encryption and Decryption Algorithm</h1>

  <p>The Advanced Encryption Standard, also known by its original name Rijndael, is a specification for the encryption of electronic data established by the U.S. National Institute of Standards and Technology in 2001.<br>

        <form name="AESEncryptor" class="card p-2" onsubmit="AESEncrypt();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Encrypt" name="fname">
          <div class="input-group-append">
              <div class="input-group">
          <input type="text" class="form-control" placeholder="Private Key" name="secname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Encrypt</button>
          </div>
        </div>
      </form>
      </div>
    </div>
  </form>
      <form name="AESDecryptor" class="card p-2" onsubmit="AESDecrypt();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="String to Decrypt" name="secname">
          <div class="input-group-append">
            <div class="input-group">
          <input type="text" class="form-control" placeholder="Private Key" name="tertname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Decrypt</button>
          </div>
        </div>
      </form>
</div>
</div>
</form>
</p>
</div>

<div class = "container py-5">
  <h1> URI Decoder </h1>
  <p> While auditing external websites, we often come across many URI's that are encoded, the Decoder below can help one to Decode such URI's <br>
           <form name="URLDecoder" class="card p-2" onsubmit="URLDecode();return false">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Valid URI to Decode" name="fname">
          <div class="input-group-append">
            <button type="submit" class="btn btn-primary">Decode</button>
          </div>
        </div>
      </form>
  
</div>
</div>
</form>
</p>
</div>



<script>
  var primes = [3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,7853,7867,7873,7877,7879,7883,7901,7907,7919
];
var alpbabets = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
function eulergcd( a, b){
     if(b==0){
         return a;
     }
     return eulergcd(b,(a%b));
}
function fmod(a,b) {
     return Number((a - (Math.floor(a / b) * b)).toPrecision(8)); 
}
function modular_exponentiation(base,power,mod){
    var res = 1;
    while(power != 0){
        if(power%2==0){
            power/=2;
            base = (base%mod * base%mod)%mod;
        }
        else{
            res = (res%mod * base%mod)%mod;
            power--;
        }
    }
    return res;
}
function extend(E,PHI) {
u1 = 1
u2 = 0
u3 = PHI
v1 = 0
v2 = 1
v3 = E     

while (v3 != 0) {
     q = Math.floor(u3/v3)
     t1 = u1 - q * v1
     t2 = u2 - q * v2
     t3 = u3 - q * v3

     u1 = v1
     u2 = v2 
     u3 = v3

     v1 = t1
     v2 = t2
     v3 = t3
     z = 1
}
uu = u1
vv = u2

if (vv < 0) {
          inverse = vv + PHI
} else {
     inverse = vv
}
return inverse
}    
function private_key(str){
    var p = primes[Math.floor(Math.random()*primes.length)];
    var q = primes[Math.floor(Math.random()*primes.length)];
    if(p == q){
        p = 2;
        q = 3;
    }
    var n = p*q;
    var phi = (p-1)*(q-1);
    var e = 3;
    while(e<phi) {
      var track = eulergcd(e,phi);
      if(track==1)
         break;
      else
         e++;
   }
   var d = extend(e,phi);
   var message = encrypt(str,e,n);
   alert("Save the following values for Decryption ! ");
   alert("Encrypted String is "+ message);
   alert("Value of N is "+ n);
   alert("Shhh! Private Key is "+ d);
}
function encrypt(str,e,n){
     var check = str.charCodeAt(0)-'A'.charCodeAt(0) + 1;
     c = Math.pow(check,e)%n;
     return c;
}
  function rsa(){
    var str = document.forms["RSA_Encrypt"]["fname"].value;
    private_key(str);
  }
function decrypt(C,N,D) {
   var dec = modular_exponentiation(C,D,N);
   alert("Decrypted Character is " + alpbabets[dec-1]);
}
function drsa(){
  var C = document.forms["RSA_Decrypt"]["fname"].value;
  var N = document.forms["RSA_Decrypt"]["secname"].value;
  var D = document.forms["RSA_Decrypt"]["tertname"].value;
  decrypt(C,N,D);
}

  function privatekey(length) {
   var result           = '';
   var characters       = '123456789';
   var charactersLength = characters.length;
      result = characters.charAt(Math.floor(Math.random() * charactersLength));
   return result;
}
  function Encrypt(){
     var str = document.forms["Encryptor"]["fname"].value;
    /* Code for deciding the random key*/
      var key = (Math.floor(Math.random() * 1000)); 
      var fstr = '';
    for(var i=0;i<str.length;i++){
      fstr += String.fromCharCode(key ^ str.charCodeAt(i));
    }
    alert("Encrypted string is : " + fstr);
    alert("Your private key is " + key);
    alert("Save it for Decryption :)");
    return false;
  }
  function Decrypt(){
    var str = document.forms["Decryptor"]["secname"].value;
    var key = document.forms["Decryptor"]["tertname"].value;
    var result = '';
    for(var i=0;i<str.length;i++){
      result += String.fromCharCode(key^str.charCodeAt(i));
    }
    alert("Decrypted String is : "+result);
    return false;
  }
  function Hash(){
    var str = document.forms["Hashing"]["fname"].value;
    var key = document.forms["Hashing"]["tertname"].value;
    var hash = CryptoJS.HmacSHA256(str,key);
    var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
    alert("Generated hash is "+hashInBase64);
  }
  function md5hash(){
    var str = document.forms["MD5"]["fname"].value;
    var hash = CryptoJS.MD5(str);
    var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);
    alert("Generated hash is "+ hashInBase64);
  }
  function AESEncrypt(){
     var str = document.forms["AESEncryptor"]["fname"].value;
     var key = document.forms["AESEncryptor"]["secname"].value;
     var hash = CryptoJS.AES.encrypt(str,key);
     alert("Encrypted Message is "+ hash);
     alert("Remember the key");
  }
  function AESDecrypt(){
    var str = document.forms["AESDecryptor"]["secname"].value;
    var key = document.forms["AESDecryptor"]["tertname"].value;
    var original = CryptoJS.AES.decrypt(str,key);
    original = CryptoJS.enc.Utf8.stringify(original);
    alert("Decrypted String is : "+original);
  }
  function URLDecode(){
    var str = document.forms["URLDecoder"]["fname"].value;
    var original = decodeURIComponent(str);
    alert("Decoded URI is "+original);
  }
</script>
  </body>
</html>

